<div class="page-header">
  <h1>Drink</h1>
</div>

<div class="row">
	<div class="col-md-4">
		<input id="new_category" type="text" class="form-control" placeholder="add a new categroy">
	</div>
</div>

<div class="row" id="show_panel">


</div>


<div class="row">
	<div class="col-md-2 category-panel" id="template_panel">
		<div class="list-group">
			<div class="list-group-item active">
				<span class="category-name">Head</span>
				<span class="glyphicon glyphicon-remove category-remove pull-right"></span>
			</div>
			<div class="list-group-item">
				<input type="text" class="form-control sub-item" placeholder="add a new item">
			</div>
		</div>
	</div>
</div>


<script language="javascript">

$(document).ready(ready);
//$(document).on('page:load', ready);
//$(document).on('page:change', ready);


function ready()
{console.log(arguments.callee.name);

	//$('#new_category').keypress(newCategoryOnPress);
	$(document).on( 'keypress', '#new_category', newCategoryOnPress );
	$(document).on( 'keypress', '.form-control.sub-item', newSubItemOnPress );
	$(document).on( 'click', '.glyphicon.glyphicon-remove.category-remove', removeCategoryOnclick );
	$(document).on( 'click', '.glyphicon.glyphicon-remove.item-remove', removeItemOnclick );
}


function removeItemOnclick()
{console.log(arguments.callee.name);

	console.log( $(this).parentsUntil('.list-group-item') );
	$(this).parent().remove();
}


function removeCategoryOnclick()
{console.log(arguments.callee.name);

	$(this).parentsUntil('.category-panel').remove();
}


function newSubItemOnPress(e)
{console.log(arguments.callee.name);

	code = (e.keyCode ? e.keyCode : e.which);
	if (code != 13)
		return;

	var content = [
		'<div class="list-group-item">',
			'<span class="category-name">',
				$(this).val(),
			'</span>',
			'<span class="glyphicon glyphicon-remove item-remove pull-right"></span>',
		'</div>'
	].join('');
	

	$(this).val('');
	$(this).parent().before(content);

}


function newCategoryOnPress(e)
{console.log(arguments.callee.name);

	code = (e.keyCode ? e.keyCode : e.which);
	if (code != 13)
		return;

	var newPanel = $('#template_panel').clone();
	newPanel.removeProp('id');
	newPanel.find('.category-name').first().text( $(this).val() );
	newPanel.appendTo('#show_panel');
	$(this).val('');
}



</script>
